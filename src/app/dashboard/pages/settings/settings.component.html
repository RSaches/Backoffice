<div class="dashboard-container">
  <app-sidebar></app-sidebar>
  
  <main class="main-content">
    <div class="settings-page">
      <div class="settings-header">
        <h1>Configurações do Sistema</h1>
        <p>Gerencie configurações de empresas, usuários e sistema</p>
      </div>

      <div class="settings-tabs">
        <button 
          class="tab-button" 
          [class.active]="activeTab === 'companies'"
          (click)="setActiveTab('companies')">
          <mat-icon>business</mat-icon>
          Empresas
        </button>
        <button 
          class="tab-button" 
          [class.active]="activeTab === 'users'"
          (click)="setActiveTab('users')">
          <mat-icon>people</mat-icon>
          Usuários
        </button>
        <button 
          class="tab-button" 
          [class.active]="activeTab === 'settings'"
          (click)="setActiveTab('settings')">
          <mat-icon>settings</mat-icon>
          Configurações
        </button>
      </div>

      <div class="settings-content">
        <!-- Conteúdo de Empresas -->
        <div *ngIf="activeTab === 'companies'" class="companies-section">
          <div class="company-registration">
            <div class="company-registration-header">
              <h2>Cadastro de Empresa</h2>
            </div>
            <div class="company-form">
              <div class="form-row">
                <div class="form-group">
                  <label>CNPJ</label>
                  <input 
                    type="text" 
                    placeholder="Digite o CNPJ" 
                    [(ngModel)]="company.cnpj"
                    ngxMask="00.000.000/0000-00"
                    (blur)="formatarCNPJ()"
                  >
                </div>
                <div class="form-group">
                  <label>Nome Fantasia</label>
                  <input 
                    type="text" 
                    placeholder="Nome Fantasia" 
                    [(ngModel)]="company.nomeFantasia"
                  >
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label>E-mail</label>
                  <input 
                    type="email" 
                    placeholder="Digite o e-mail" 
                    [(ngModel)]="company.email"
                  >
                </div>
                <div class="form-group">
                  <label>Telefone</label>
                  <input 
                    type="text" 
                    placeholder="Telefone" 
                    [(ngModel)]="company.telefone"
                    ngxMask="(00) 00000-0000"
                  >
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label>ID G-Chat</label>
                  <input 
                    type="text" 
                    placeholder="ID G-Chat" 
                    [(ngModel)]="company.idGChat"
                  >
                </div>
                <div class="form-group">
                  <label>Nome G-Chat</label>
                  <input 
                    type="text" 
                    placeholder="Nome G-Chat" 
                    [(ngModel)]="company.nomeGChat"
                  >
                </div>
              </div>

              <div class="form-row">
                <div class="form-group full-width">
                  <label>Token</label>
                  <div class="token-input-container">
                    <input 
                      type="text" 
                      placeholder="Token" 
                      [(ngModel)]="company.token"
                      class="token-input"
                    >
                    <button 
                      class="btn-search" 
                      (click)="buscarToken()"
                    >
                      Buscar
                    </button>
                  </div>
                </div>
              </div>

              <div class="form-actions">
                <button class="btn-save" (click)="salvarEmpresa()">
                  <mat-icon>{{ isEditMode ? 'update' : 'save' }}</mat-icon> 
                  {{ isEditMode ? 'Atualizar Empresa' : 'Salvar Empresa' }}
                </button>
                <button *ngIf="isEditMode" class="btn-cancel" (click)="cancelarEdicao()">
                  <mat-icon>cancel</mat-icon> Cancelar Edição
                </button>
              </div>
            </div>
          </div>

          <div class="companies-list-section">
            <h2>Empresas Cadastradas</h2>
            <div class="companies-table-container">
              <table>
                <thead>
                  <tr>
                    <th>CNPJ</th>
                    <th>Nome Fantasia</th>
                    <th>E-mail</th>
                    <th>Telefone</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let comp of companiesList">
                    <td>{{ comp.cnpj }}</td>
                    <td>{{ comp.nomeFantasia }}</td>
                    <td>{{ comp.email }}</td>
                    <td>{{ comp.telefone }}</td>
                    <td class="actions-cell">
                      <button class="btn-edit" (click)="editarEmpresa(comp)">
                        <mat-icon>edit</mat-icon>
                      </button>
                      <button class="btn-delete" (click)="excluirEmpresa(comp)">
                        <mat-icon>delete</mat-icon>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <p *ngIf="companiesList.length === 0" class="no-companies">
                Nenhuma empresa cadastrada.
              </p>
            </div>
          </div>
        </div>

        <!-- Conteúdo de Usuários -->
        <div *ngIf="activeTab === 'users'" class="users-section">
          <div class="user-registration">
            <div class="user-registration-header">
              <h2>Cadastro de Usuário</h2>
            </div>
            <div class="user-form">
              <div class="form-row">
                <div class="form-group">
                  <label>Nome</label>
                  <input 
                    type="text" 
                    placeholder="Digite o nome" 
                    [(ngModel)]="user.nome"
                  >
                </div>
                <div class="form-group">
                  <label>E-mail</label>
                  <input 
                    type="email" 
                    placeholder="Digite o e-mail" 
                    [(ngModel)]="user.email"
                  >
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label>Permissão</label>
                  <select 
                    [(ngModel)]="user.permissao"
                    class="full-width-select"
                  >
                    <option value="admin">Administrador</option>
                    <option value="usuario">Usuário</option>
                    <option value="visualizador">Visualizador</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>Senha</label>
                  <div class="input-group">
                    <input 
                      [type]="showPassword ? 'text' : 'password'" 
                      placeholder="Digite a senha"
                      [(ngModel)]="user.senha"
                      class="form-control"
                    >
                    <div class="input-group-append">
                      <span 
                        class="input-group-text" 
                        (click)="togglePasswordVisibility()"
                      >
                        <mat-icon>
                          {{ showPassword ? 'visibility_off' : 'visibility' }}
                        </mat-icon>
                      </span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-actions">
                <button class="btn-save" (click)="salvarUsuario()">
                  <mat-icon>{{ isUserEditMode ? 'update' : 'save' }}</mat-icon> 
                  {{ isUserEditMode ? 'Atualizar Usuário' : 'Salvar Usuário' }}
                </button>
                <button *ngIf="isUserEditMode" class="btn-cancel" (click)="cancelarEdicaoUsuario()">
                  <mat-icon>cancel</mat-icon> Cancelar Edição
                </button>
              </div>
            </div>
          </div>

          <div class="users-list-section">
            <h2>Usuários Cadastrados</h2>
            <div class="users-table-container">
              <table>
                <thead>
                  <tr>
                    <th>Nome</th>
                    <th>E-mail</th>
                    <th>Permissão</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let usuario of usersList">
                    <td>{{ usuario.nome }}</td>
                    <td>{{ usuario.email }}</td>
                    <td>
                      <span class="user-badge">
                        {{ 
                          usuario.permissao === 'admin' ? 'Administrador' : 
                          usuario.permissao === 'usuario' ? 'Usuário' : 
                          'Visualizador'
                        }}
                      </span>
                    </td>
                    <td class="actions-cell">
                      <button class="btn-edit" (click)="editarUsuario(usuario)">
                        <mat-icon>edit</mat-icon>
                      </button>
                      <button class="btn-delete" (click)="excluirUsuario(usuario)">
                        <mat-icon>delete</mat-icon>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <p *ngIf="usersList.length === 0" class="no-users">
                Nenhum usuário cadastrado.
              </p>
            </div>
          </div>
        </div>

        <!-- Conteúdo de Configurações -->
        <div *ngIf="activeTab === 'settings'" class="general-settings">
          <div class="settings-grid">
            <div class="settings-column">
              <h2>Configurações Gerais</h2>
              <div class="setting-group">
                <div class="setting-item">
                  <label>Tema</label>
                  <select>
                    <option>Claro</option>
                    <option>Escuro</option>
                    <option>Sistema</option>
                  </select>
                </div>
                
                <div class="setting-item">
                  <label>Idioma</label>
                  <select>
                    <option>Português</option>
                    <option>Inglês</option>
                    <option>Espanhol</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="settings-column">
              <h2>Configurações de Conta</h2>
              <div class="setting-group">
                <div class="setting-item">
                  <label>Nome de Usuário</label>
                  <input type="text" placeholder="Seu nome de usuário">
                </div>
                
                <div class="setting-item">
                  <label>Email</label>
                  <input type="email" placeholder="Seu email">
                </div>

                <div class="setting-item">
                  <label>Alterar Senha</label>
                  <div class="password-change">
                    <input type="password" placeholder="Nova senha">
                    <input type="password" placeholder="Confirmar nova senha">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
